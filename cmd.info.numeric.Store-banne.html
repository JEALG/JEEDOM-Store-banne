<div style="padding:0;width:110px;min-height:118px;" class="cmd tooltips cmd-widget cursor container-fluid #history# " data-type="info" data-subtype="numeric" data-cmd_id="#id#" data-cmd_uid="#uid#" data-eqLogic_id="#eqLogic_id#" data-eqLogic_id="#eqLogic_id#" title="#collectDate#">
 	<!-- Info Widget
		Basé sur les widget de	: breizh33
		Mise à jour				: JAG 20190130 : Ajout possibilité de changer l'image et de fonctionner de 0 à 100 ou de 100 à 0 et correction du niveau 10 absent
		Mise à jour				: JAG 20190317 : ajout centrer widget (merci à Antoinekl1)
		Mise à jour				: JAG 20190327 : Amélioration code Ajout variable pour définir l'extension du fichier (merci à fishes)
		Mise à jour				: JAG 20190505 : Ajout durée "Derniere durée changement dernier etat" Merci @Salvialf pour le code
	-->
	<div class="row">
		<center>
			<div class="cmdName" id="cmdName#id#" style="font-weight: bold;font-size : 10px; #hideCmdName#;">#name_display# </div>
			<div style="font-size: 2.5em;margin-top:5px;" class="iconCmd"></div>
          	<div>
				<!-- Affichage Valeur -->
					<span class='label label-default value label-state#id#'style="font-size: 11px;"></span><br/>
          		<!-- Derniere durée changement dernier etat-->
          			<span class='label label-default value label-time#id#'style="font-size: 10px;"></span><br/>
				<!-- Historique -->
					<div class="#hide_history# label label-default value" style="#displayHistory# font-size : 8px">
						<span style='font-size : 8px' title="Min">#minHistoryValue##unite# | </span><span style='font-size : 8px' title="Max" class="tooltips">#maxHistoryValue##unite#</span> <i style='font-size : 8px' class="#tendance#"></i>
					</div>			
			</div>
		</center>
	</div>
</div>
<script>
	jeedom.cmd.update['#id#'] = function(_options){
		// Options de personnalisation avec valeur par defaut
			// Paramètre "sizehw" : à déclarer en pixels - 80 maxi
				var srcImgHeight 	= (is_numeric('#sizeh#')) 	? parseFloat('#sizeh#') 	: 90;
				var srcImgWidth		= (is_numeric('#sizew#')) 	? parseFloat('#sizew#') 	: 90;
				var srcImgSize 		= 'height='+srcImgHeight+'px width='+srcImgWidth+'px';
			// Paramétrage Niveau
				var srcImgLevel		= (is_numeric('#levelINV#')) 	? parseFloat('#levelINV#') 	: 0;	
			// Affichage durée changement dernier etat
				var srcImglogoTime = '#logoTime#';
			// Paramétrage des images
				var srcImgURL 		= 'plugins/widget/core/template/dashboard/cmd.info.numeric.Store-banne/';
			// Paramètrage du logo		  	  
				var srcImglogo		= ('#logo#'!='#'+'logo#') ? "#logo#" : "StoreExt_";
				var srcImglogo_T 	= ('#logo_type#'!='#'+'logo_type#') ? "#logo_type#" : "png";	
			// Paramètrage du logo Erreur	
				var srcImglogoER	= ('#logo_error#'!='#'+'logo_error#') ? "#logo_error#" : "oups";
				var srcImglogoER_T 	= ('#logoER_type#'!='#'+'logoER_type#') ? "#logoER_type#" : "png";
			// Variable Image
				var srcPictureID;
				var srcPictureIDinv;
      
			// Update
				var State = parseFloat(_options.display_value);	
					if (State == 0) {
						srcPictureID 	= "0";
						srcPictureIDinv = "100";
					} else if (State > 0 && State <= 10) {
						srcPictureID 	= "10";
						srcPictureIDinv = "90";
					} else if (State > 10 && State <= 20) {
						srcPictureID 	= "20";
						srcPictureIDinv = "80";
					} else if (State > 20 && State <= 30) {
						srcPictureID 	= "30";
						srcPictureIDinv = "70";
					} else if (State > 30 && State <= 40) {
						srcPictureID 	= "40";
						srcPictureIDinv = "60";
					} else if (State > 40 && State <= 50) {
						srcPictureID 	= "50";
						srcPictureIDinv = "50";
					} else if (State > 50 && State <= 60) {
						srcPictureID 	= "60";
						srcPictureIDinv = "40";
					} else if (State > 60 && State <= 70) {
						srcPictureID 	= "70";
						srcPictureIDinv = "30";
					} else if (State > 70 && State <= 80) {
						srcPictureID 	= "80";
						srcPictureIDinv = "20";
					} else if (State > 80 && State <= 90) {
						srcPictureID 	= "90";
						srcPictureIDinv = "10";
					} else if (State > 90 && State <= 100) {
						srcPictureID 	= "100";
						srcPictureIDinv = "0";
					} else {
						srcPictureID 	= "error";
					}          

			// Update IMG + gestion erreur
				if (srcPictureID == "error"){
					$('.cmd[data-cmd_uid=#uid#] .iconCmd').html('<img src="'+srcImgURL +srcImglogoER +'.'+ srcImglogoER_T+'" '+srcImgSize+'>');
				} else {
					// Update en fonction level
						if (srcImgLevel == 1 ) {
							var srcImglogoLevel = srcImgURL + srcImglogo +srcPictureIDinv;
						} else {
							var srcImglogoLevel = srcImgURL + srcImglogo +srcPictureID;
						} 
					$('.cmd[data-cmd_uid=#uid#] .iconCmd').html('<img src="'+srcImglogoLevel +'.'+ srcImglogo_T+'" '+srcImgSize+'>');
				}
					$('.cmd[data-cmd_uid=#uid#] .label-state#id#').html(State+' '+'#unite#');
					$('.cmd[data-cmd_id=#id#]').attr('title','Valeur du '+_options.valueDate+', collectée le '+_options.collectDate);

		// Derniere durée changement dernier etat
			//Merci @Salvialf pour le code
			if (srcImglogoTime == "duree") {
				jeedom.cmd.displayDuration(_options.valueDate, $('.cmd[data-cmd_id=#id#] .label-time#id#'));
			} else if (srcImglogoTime == "date") {
				var srcdate = new Date(_options.valueDate);
				var srcformat = $.datepicker.formatDate('D dd/mm', srcdate);
				var srctime = "à "+srcdate.getHours()+":"+(srcdate.getMinutes()<10?'0':'')+srcdate.getMinutes();
				$('.cmd[data-cmd_id=#id#] .label-time#id#').empty().html(srcformat+'<br>'+srctime);
			} else if (srcImglogoTime == "heure") {
				var srcdate = new Date(_options.valueDate);
				var srctime = "à "+srcdate.getHours()+":"+(srcdate.getMinutes()<10?'0':'')+srcdate.getMinutes()+":"+(srcdate.getSeconds()<10?'0':'')+srcdate.getSeconds()+"";
				$('.cmd[data-cmd_id=#id#] .label-time#id#').empty().html(srctime);
			};
		
	}
		jeedom.cmd.update['#id#']({display_value:'#state#',valueDate:'#valueDate#',collectDate:'#collectDate#',alertLevel:'#alertLevel#'});      
</script>